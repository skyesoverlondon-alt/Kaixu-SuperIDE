<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>JWT Secret Generator</title>
  <meta name="description" content="Generate strong JWT secrets (hex or base64url) using secure browser randomness." />
  <style>
    :root{
      --bg:#070816;
      --card:#0c1030cc;
      --card2:#0b0e24cc;
      --text:#e9ecff;
      --muted:#b7bce8;
      --line:#ffffff18;
      --purple:#7b2cff;
      --gold:#ffcc33;
      --ok:#30e0a1;
      --warn:#ffb020;
      --bad:#ff4d6d;
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background: radial-gradient(1100px 700px at 20% 10%, rgba(123,44,255,.22), transparent 55%),
                  radial-gradient(900px 600px at 80% 20%, rgba(255,204,51,.18), transparent 60%),
                  radial-gradient(1200px 900px at 50% 110%, rgba(48,224,161,.10), transparent 60%),
                  linear-gradient(180deg, #050611, #06071a 40%, #050611);
      overflow-x:hidden;
    }
    .stars{
      position:fixed; inset:0; pointer-events:none; opacity:.5;
      background-image:
        radial-gradient(1px 1px at 12% 18%, rgba(255,255,255,.8), transparent 45%),
        radial-gradient(1px 1px at 22% 78%, rgba(255,255,255,.7), transparent 45%),
        radial-gradient(1px 1px at 64% 34%, rgba(255,255,255,.8), transparent 45%),
        radial-gradient(1px 1px at 78% 66%, rgba(255,255,255,.75), transparent 45%),
        radial-gradient(1px 1px at 44% 56%, rgba(255,255,255,.65), transparent 45%),
        radial-gradient(1px 1px at 90% 22%, rgba(255,255,255,.7), transparent 45%),
        radial-gradient(1px 1px at 8% 52%, rgba(255,255,255,.6), transparent 45%),
        radial-gradient(1px 1px at 52% 12%, rgba(255,255,255,.65), transparent 45%);
      filter: drop-shadow(0 0 6px rgba(123,44,255,.15));
      animation: drift 18s linear infinite;
    }
    @keyframes drift{
      0%{transform: translate3d(0,0,0)}
      50%{transform: translate3d(-10px,6px,0)}
      100%{transform: translate3d(0,0,0)}
    }

    .wrap{
      max-width:1100px;
      margin:0 auto;
      padding:28px 18px 60px;
      position:relative;
    }

    header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:18px;
      margin: 12px 0 22px;
    }
    .title{
      display:flex; flex-direction:column; gap:6px;
    }
    h1{
      margin:0;
      font-size: clamp(22px, 2.8vw, 34px);
      letter-spacing:.2px;
      line-height:1.1;
    }
    .subtitle{
      color:var(--muted);
      font-size: 14px;
      line-height:1.4;
      max-width: 68ch;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border:1px solid var(--line);
      border-radius: 999px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow: 0 10px 40px rgba(0,0,0,.25);
      user-select:none;
      white-space:nowrap;
      height: fit-content;
    }
    .dot{
      width:10px; height:10px; border-radius:99px;
      background: radial-gradient(circle at 30% 30%, #fff, rgba(255,255,255,.2)),
                  linear-gradient(180deg, var(--purple), #3a0fb8);
      box-shadow: 0 0 18px rgba(123,44,255,.5);
    }
    .pill span{color:var(--muted); font-size:12px}
    .pill b{color:var(--text); font-size:12px; font-weight:600}

    .grid{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:16px;
    }
    @media (max-width: 920px){
      .grid{grid-template-columns:1fr}
      header{flex-direction:column}
      .pill{align-self:flex-start}
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .head{
      padding:16px 16px 12px;
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(123,44,255,.10), rgba(255,255,255,0));
    }
    .card .head h2{
      margin:0;
      font-size:15px;
      letter-spacing:.2px;
    }
    .card .head p{
      margin:6px 0 0;
      color:var(--muted);
      font-size:12.5px;
      line-height:1.45;
    }
    .card .body{padding:16px}

    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-bottom:12px;
    }
    @media (max-width: 520px){
      .row{grid-template-columns:1fr}
    }

    label{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin-bottom:6px;
    }
    select, input[type="number"], input[type="text"]{
      width:100%;
      padding:11px 12px;
      border-radius:12px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.25);
      color: var(--text);
      outline:none;
    }
    input[type="range"]{
      width:100%;
      accent-color: var(--purple);
    }
    .rangeWrap{
      padding:12px 12px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.20);
    }
    .rangeTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:10px;
    }
    .badge{
      font-size:12px;
      color:var(--text);
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      box-shadow: 0 0 0 1px rgba(0,0,0,.15) inset;
    }
    .hint{
      font-size:12px;
      color:var(--muted);
      margin-top:8px;
      line-height:1.45;
    }

    .btns{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
    }
    button{
      border:none;
      cursor:pointer;
      padding:11px 14px;
      border-radius: 14px;
      font-weight:650;
      letter-spacing:.2px;
      color:#0a0b16;
      background: linear-gradient(180deg, var(--gold), #ffb703);
      box-shadow: 0 14px 34px rgba(255,204,51,.18), 0 10px 30px rgba(0,0,0,.35);
      transition: transform .12s ease, filter .12s ease;
    }
    button:hover{transform: translateY(-1px); filter: brightness(1.02)}
    button:active{transform: translateY(0px); filter: brightness(.98)}
    .btn2{
      color: var(--text);
      background: linear-gradient(180deg, rgba(123,44,255,.9), rgba(80,26,200,.92));
      box-shadow: 0 14px 34px rgba(123,44,255,.18), 0 10px 30px rgba(0,0,0,.35);
    }
    .btn3{
      color: var(--text);
      background: rgba(255,255,255,.06);
      border:1px solid var(--line);
      box-shadow: none;
    }

    textarea{
      width:100%;
      min-height: 134px;
      resize: vertical;
      padding:12px;
      border-radius: 14px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.28);
      color: var(--text);
      outline:none;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12.5px;
      line-height:1.45;
    }

    .meter{
      margin-top:10px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .bar{
      flex:1;
      height:10px;
      border-radius: 999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      overflow:hidden;
    }
    .fill{
      height:100%;
      width:0%;
      border-radius:999px;
      background: linear-gradient(90deg, var(--bad), var(--warn), var(--ok));
      filter: saturate(1.1);
      transition: width .25s ease;
    }
    .meterText{
      font-size:12px;
      color: var(--muted);
      min-width: 150px;
      text-align:right;
    }

    .toast{
      position: fixed;
      bottom: 18px;
      left: 50%;
      transform: translateX(-50%) translateY(16px);
      opacity:0;
      pointer-events:none;
      padding: 10px 12px;
      border-radius: 999px;
      background: rgba(10,12,30,.92);
      border:1px solid var(--line);
      color: var(--text);
      box-shadow: var(--shadow);
      transition: opacity .2s ease, transform .2s ease;
      font-size: 12px;
    }
    .toast.show{opacity:1; transform: translateX(-50%) translateY(0)}

    .history{
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .hitem{
      padding:12px;
      border-radius: 14px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.22);
    }
    .hmeta{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:8px;
      color: var(--muted);
      font-size: 12px;
    }
    .hmeta b{color: var(--text); font-weight:650}
    .hsecret{
      display:flex;
      gap:10px;
      align-items:center;
    }
    .mask{
      flex:1;
      padding:10px 12px;
      border-radius: 12px;
      border:1px dashed rgba(255,255,255,.20);
      background: rgba(255,255,255,.04);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      color: var(--text);
      overflow:hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .smallbtn{
      padding:9px 11px;
      border-radius: 12px;
      font-size: 12px;
      font-weight:650;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      color: var(--text);
      box-shadow:none;
    }

    .note{
      padding:12px 12px;
      border-radius: 14px;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,77,109,.10), rgba(255,255,255,.02));
      color: var(--muted);
      font-size: 12.5px;
      line-height:1.45;
    }
    .note b{color: var(--text)}
    .note code{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      color: #f2f3ff;
      background: rgba(0,0,0,.25);
      border:1px solid var(--line);
      padding:2px 6px;
      border-radius: 8px;
    }

    .footer{
      margin-top:16px;
      color: rgba(183,188,232,.85);
      font-size: 12px;
      text-align:center;
    }
    .footer a{color: var(--gold); text-decoration:none}
  </style>
</head>

<body>
  <!-- SOL Platform Nav -->
  <div id="sol-platnav" style="position:fixed;bottom:18px;right:18px;z-index:99999;display:flex;flex-direction:column;gap:6px;font-family:ui-sans-serif,system-ui,sans-serif;">
    <a href="/index.html" style="padding:8px 15px;border-radius:999px;background:rgba(5,4,10,.92);border:1px solid rgba(255,255,255,.16);color:#f2f0ff;text-decoration:none;backdrop-filter:blur(12px);white-space:nowrap;font-size:11px;font-weight:700;letter-spacing:.15px;box-shadow:0 10px 34px rgba(0,0,0,.55);display:block;text-align:center;" onmouseover="this.style.borderColor='rgba(184,107,255,.6)'" onmouseout="this.style.borderColor='rgba(255,255,255,.16)'">&#8592; SOL Home</a>
    <a href="/Platforms-Apps-Infrastructure/" style="padding:8px 15px;border-radius:999px;background:rgba(5,4,10,.92);border:1px solid rgba(255,255,255,.16);color:#f2f0ff;text-decoration:none;backdrop-filter:blur(12px);white-space:nowrap;font-size:11px;font-weight:700;letter-spacing:.15px;box-shadow:0 10px 34px rgba(0,0,0,.55);display:block;text-align:center;" onmouseover="this.style.borderColor='rgba(59,214,255,.6)'" onmouseout="this.style.borderColor='rgba(255,255,255,.16)'">&#11043; All Platforms</a>
  </div>
  <script src="/js/netlify-identity-init.js"></script>
  <div class="stars"></div>

  <div class="wrap">
    <header>
      <div class="title">
        <h1>JWT Secret Generator üîê</h1>
        <div class="subtitle">
          Generates cryptographically-strong secrets in your browser using <b>crypto.getRandomValues</b>. Pick a byte length,
          choose hex or base64url, hit generate, and copy straight into your env.
        </div>
      </div>
      <div class="pill" aria-label="security status">
        <div class="dot"></div>
        <div>
          <span>Randomness source</span><br />
          <b id="rngStatus">Checking‚Ä¶</b>
        </div>
      </div>
    </header>

    <div class="grid">
      <section class="card">
        <div class="head">
          <h2>Generate</h2>
          <p>Recommended: <b>64 bytes</b> (512 bits) for HMAC JWT (HS256/HS512). Larger is fine.</p>
        </div>
        <div class="body">
          <div class="row">
            <div>
              <label for="encoding">Output format</label>
              <select id="encoding">
                <option value="hex">Hex (env-safe, longer)</option>
                <option value="base64url" selected>Base64URL (compact, env-safe)</option>
                <option value="base64">Base64 (includes + / =)</option>
              </select>
              <div class="hint">For most .env files, <b>base64url</b> is the cleanest.</div>
            </div>

            <div>
              <label for="prefixMode">Prefix</label>
              <select id="prefixMode">
                <option value="none" selected>No prefix</option>
                <option value="jwt_secret">JWT_SECRET=</option>
                <option value="custom">Custom‚Ä¶</option>
              </select>
              <input id="customPrefix" type="text" placeholder="e.g., MY_APP_JWT_SECRET=" style="margin-top:10px; display:none;" />
            </div>
          </div>

          <div class="rangeWrap" style="margin-bottom:12px;">
            <div class="rangeTop">
              <div>
                <label for="bytes" style="margin:0; color:var(--text); font-weight:700;">Secret length</label>
                <div class="hint" style="margin-top:6px;">More bytes = more entropy. Don‚Äôt be stingy with randomness.</div>
              </div>
              <div class="badge"><span id="bytesLabel">64</span> bytes ‚Ä¢ <span id="bitsLabel">512</span> bits</div>
            </div>
            <input id="bytes" type="range" min="16" max="128" step="16" value="64" />
            <div class="hint">Common picks: 32 (ok), 64 (strong), 96‚Äì128 (ultra).</div>
          </div>

          <div class="btns">
            <button id="genBtn" type="button">Generate Secret</button>
            <button id="copyBtn" type="button" class="btn2">Copy</button>
            <button id="clearBtn" type="button" class="btn3">Clear</button>
          </div>

          <div style="margin-top:12px;">
            <label for="output">Output</label>
            <textarea id="output" readonly spellcheck="false" placeholder="Your secret will appear here‚Ä¶"></textarea>

            <div class="meter" aria-label="strength meter">
              <div class="bar"><div class="fill" id="fill"></div></div>
              <div class="meterText" id="meterText">Entropy: ‚Äî</div>
            </div>
          </div>

          <div style="margin-top:12px;" class="note">
            <b>Important:</b> This is for <b>HMAC</b> JWT secrets (HS256/HS384/HS512). If you‚Äôre using <b>RS256/ES256</b>,
            you need a real keypair (private/public key), not a shared ‚Äúsecret.‚Äù Also: never commit secrets; use env vars.
            Example: <code>JWT_SECRET="‚Ä¶"</code>
          </div>
        </div>
      </section>

      <aside class="card">
        <div class="head">
          <h2>History (local only)</h2>
          <p>Last 10 generated secrets. You can copy from here. Nothing is uploaded anywhere.</p>
        </div>
        <div class="body">
          <div class="history" id="history"></div>
          <div class="footer" style="margin-top:14px;">
            Tip: rotate secrets if you suspect exposure. Rotating invalidates existing tokens (which is sometimes the point).
          </div>
        </div>
      </aside>
    </div>

    <div class="footer" style="margin-top:18px;">
      Built as a single-file app. Drop it on Netlify as <b>index.html</b> and you‚Äôre live. ‚ö°
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    (function(){
      const $ = (id) => document.getElementById(id);

      const encodingEl = $("encoding");
      const bytesEl = $("bytes");
      const bytesLabel = $("bytesLabel");
      const bitsLabel = $("bitsLabel");
      const outputEl = $("output");
      const genBtn = $("genBtn");
      const copyBtn = $("copyBtn");
      const clearBtn = $("clearBtn");
      const fillEl = $("fill");
      const meterText = $("meterText");
      const toastEl = $("toast");
      const rngStatus = $("rngStatus");
      const historyEl = $("history");
      const prefixModeEl = $("prefixMode");
      const customPrefixEl = $("customPrefix");

      const HISTORY_LIMIT = 10;
      let history = [];

      function showToast(msg){
        toastEl.textContent = msg;
        toastEl.classList.add("show");
        window.clearTimeout(showToast._t);
        showToast._t = window.setTimeout(()=> toastEl.classList.remove("show"), 1600);
      }

      function hasCrypto(){
        return (window.crypto && window.crypto.getRandomValues);
      }

      function updateRngStatus(){
        rngStatus.textContent = hasCrypto() ? "Secure (Web Crypto)" : "Unavailable (no secure RNG)";
        rngStatus.style.color = hasCrypto() ? "var(--ok)" : "var(--bad)";
      }

      function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

      function entropyBits(byteLen){ return byteLen * 8; }

      function updateMeter(byteLen){
        const bits = entropyBits(byteLen);
        // Rough scale: 128 bits = okay, 256 = strong, 512 = very strong, 1024 = absurd.
        const pct = clamp((bits / 1024) * 100, 0, 100);
        fillEl.style.width = pct.toFixed(1) + "%";

        let label = "‚Äî";
        let color = "var(--muted)";
        if(bits < 128){ label = "Too small"; color = "var(--bad)"; }
        else if(bits < 256){ label = "Okay"; color = "var(--warn)"; }
        else if(bits < 512){ label = "Strong"; color = "var(--ok)"; }
        else { label = "Very strong"; color = "var(--ok)"; }

        meterText.textContent = `Entropy: ${bits} bits ‚Ä¢ ${label}`;
        meterText.style.color = color;
      }

      function bytesToHex(bytes){
        let out = "";
        for(let i=0;i<bytes.length;i++){
          out += bytes[i].toString(16).padStart(2,"0");
        }
        return out;
      }

      function bytesToBase64(bytes){
        // Convert bytes to binary string, then btoa
        let bin = "";
        const chunk = 0x8000;
        for(let i=0;i<bytes.length;i+=chunk){
          const sub = bytes.subarray(i, i+chunk);
          bin += String.fromCharCode.apply(null, sub);
        }
        return btoa(bin);
      }

      function base64ToBase64Url(b64){
        return b64.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");
      }

      function makeRandomBytes(n){
        const arr = new Uint8Array(n);
        window.crypto.getRandomValues(arr);
        return arr;
      }

      function getPrefix(){
        const mode = prefixModeEl.value;
        if(mode === "jwt_secret") return "JWT_SECRET=";
        if(mode === "custom") return (customPrefixEl.value || "");
        return "";
      }

      function formatSecret(bytes, enc){
        if(enc === "hex") return bytesToHex(bytes);
        if(enc === "base64") return bytesToBase64(bytes);
        if(enc === "base64url") return base64ToBase64Url(bytesToBase64(bytes));
        return bytesToHex(bytes);
      }

      function renderHistory(){
        historyEl.innerHTML = "";
        if(history.length === 0){
          const div = document.createElement("div");
          div.className = "note";
          div.style.background = "linear-gradient(180deg, rgba(123,44,255,.10), rgba(255,255,255,.02))";
          div.innerHTML = "<b>No secrets yet.</b> Generate one and it‚Äôll show up here (masked).";
          historyEl.appendChild(div);
          return;
        }

        history.forEach((h, idx) => {
          const item = document.createElement("div");
          item.className = "hitem";

          const meta = document.createElement("div");
          meta.className = "hmeta";
          meta.innerHTML = `<div><b>${h.bytes} bytes</b> ‚Ä¢ ${h.bits} bits ‚Ä¢ ${h.enc}</div><div>${h.time}</div>`;

          const row = document.createElement("div");
          row.className = "hsecret";

          const mask = document.createElement("div");
          mask.className = "mask";
          mask.textContent = h.revealed ? h.value : "‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢";

          const reveal = document.createElement("button");
          reveal.type = "button";
          reveal.className = "smallbtn";
          reveal.textContent = h.revealed ? "Hide" : "Reveal";
          reveal.addEventListener("click", () => {
            h.revealed = !h.revealed;
            renderHistory();
          });

          const copy = document.createElement("button");
          copy.type = "button";
          copy.className = "smallbtn";
          copy.textContent = "Copy";
          copy.addEventListener("click", async () => {
            try{
              await navigator.clipboard.writeText(h.value);
              showToast("Copied from history ‚úÖ");
            }catch(e){
              fallbackCopy(h.value);
            }
          });

          row.appendChild(mask);
          row.appendChild(reveal);
          row.appendChild(copy);

          item.appendChild(meta);
          item.appendChild(row);

          historyEl.appendChild(item);
        });
      }

      function nowStamp(){
        const d = new Date();
        const pad = (n)=> String(n).padStart(2,"0");
        return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
      }

      function fallbackCopy(text){
        // older browsers / restricted clipboard contexts
        outputEl.focus();
        outputEl.select();
        try{
          document.execCommand("copy");
          showToast("Copied ‚úÖ");
        }catch(e){
          showToast("Copy blocked ‚Äî select and copy manually");
        }
        window.getSelection()?.removeAllRanges?.();
      }

      function generate(){
        if(!hasCrypto()){
          showToast("No secure RNG available in this browser");
          return;
        }
        const byteLen = parseInt(bytesEl.value, 10);
        const enc = encodingEl.value;
        const prefix = getPrefix();
        const bytes = makeRandomBytes(byteLen);
        const secret = formatSecret(bytes, enc);

        const finalVal = prefix ? (prefix + secret) : secret;
        outputEl.value = finalVal;

        const bits = entropyBits(byteLen);
        updateMeter(byteLen);

        history.unshift({
          bytes: byteLen,
          bits,
          enc,
          value: finalVal,
          time: nowStamp(),
          revealed: false
        });
        history = history.slice(0, HISTORY_LIMIT);
        renderHistory();

        showToast("Secret generated ‚úÖ");
      }

      function updateBytesUI(){
        const byteLen = parseInt(bytesEl.value, 10);
        bytesLabel.textContent = byteLen;
        bitsLabel.textContent = entropyBits(byteLen);
        updateMeter(byteLen);
      }

      function updatePrefixUI(){
        const mode = prefixModeEl.value;
        customPrefixEl.style.display = (mode === "custom") ? "block" : "none";
      }

      genBtn.addEventListener("click", generate);

      copyBtn.addEventListener("click", async () => {
        const text = outputEl.value.trim();
        if(!text){
          showToast("Nothing to copy yet");
          return;
        }
        try{
          await navigator.clipboard.writeText(text);
          showToast("Copied ‚úÖ");
        }catch(e){
          fallbackCopy(text);
        }
      });

      clearBtn.addEventListener("click", () => {
        outputEl.value = "";
        showToast("Cleared");
      });

      bytesEl.addEventListener("input", updateBytesUI);
      prefixModeEl.addEventListener("change", updatePrefixUI);

      // Init
      updateRngStatus();
      updateBytesUI();
      updatePrefixUI();
      renderHistory();

      // Generate once on load (optional behavior, but handy)
      generate();
    })();
  </script>
</body>
</html>