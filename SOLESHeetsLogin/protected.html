<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="dark" />
  <title>Protected</title>
  <style>
    body{
      margin:0; min-height:100vh; display:grid; place-items:center;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: radial-gradient(900px 600px at 50% 0%, rgba(255,207,90,.12), transparent 60%),
                  radial-gradient(900px 600px at 20% 30%, rgba(124,58,237,.22), transparent 60%),
                  radial-gradient(900px 600px at 80% 40%, rgba(59,130,246,.16), transparent 60%),
                  linear-gradient(180deg, #060712, #05060a 60%, #04040a);
      color: rgba(255,255,255,.92);
      padding: 22px;
    }
    .card{
      max-width: 860px;
      width: 100%;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      box-shadow: 0 30px 70px rgba(0,0,0,.65);
      padding: 18px;
    }
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
    .muted{color: rgba(255,255,255,.70)}
    .btn{
      display:inline-block; margin-top:10px;
      padding:10px 12px; border-radius:14px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color: rgba(255,255,255,.9);
      text-decoration:none;
      font-weight: 760;
    }
    .btn:hover{background: rgba(255,255,255,.11)}
    pre{
      margin-top:12px;
      background: rgba(0,0,0,.25);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 14px;
      padding: 12px;
      overflow:auto;
    }
  </style>
</head>
<body>
  <div class="card">
    <div style="font-weight:820; font-size:18px">Protected Page ✅</div>
    <div class="muted" style="margin-top:8px; line-height:1.6">
      This page calls <span class="mono">/.netlify/functions/me</span>. If not authenticated, it redirects back to
      <span class="mono">/index.html?next=</span> this page.
    </div>

    <a class="btn" href="./index.html">Back to Login</a>
    <pre id="out" class="mono">Checking session…</pre>
  </div>

<script>
(async () => {
  const out = document.getElementById("out");
  const res = await fetch("/.netlify/functions/me", { credentials: "include" });
  let data = null;
  try { data = await res.json(); } catch(e) {}
  if(!data || !data.ok){
    const next = encodeURIComponent("/protected.html");
    location.href = "/index.html?next=" + next;
    return;
  }
  out.textContent = JSON.stringify(data, null, 2);
})();
</script>
</body>
</html>
